/**
 * Types for Vulnerability Visualization Views
 */

// TerrainView data types - 3D terrain where height = CVSS, color = severity
export interface TerrainDataPoint {
  cve_id: string;
  cvss_score: number;
  epss_score: number;
  severity: "Critical" | "High" | "Medium" | "Low";
  is_kev: boolean;
  exploit_count: number;
  x: number; // Grid position
  y: number; // Grid position
}

export interface TerrainViewData {
  points: TerrainDataPoint[];
  grid_size: number;
  max_cvss: number;
  total_cves: number;
}

// CalendarHeatmap data types - GitHub-style calendar showing CVE discoveries
export interface CalendarDayData {
  date: string; // YYYY-MM-DD format
  count: number;
  critical_count: number;
  high_count: number;
  medium_count: number;
  low_count: number;
}

export interface CalendarHeatmapData {
  days: CalendarDayData[];
  start_date: string;
  end_date: string;
  max_count: number;
  total_cves: number;
}

// SunburstChart data types - Hierarchical CWE visualization
export interface SunburstNode {
  name: string;
  value: number;
  children?: SunburstNode[];
  cwe_id?: string;
  severity_counts?: {
    critical: number;
    high: number;
    medium: number;
    low: number;
  };
}

export interface SunburstChartData {
  root: SunburstNode;
  total_cves: number;
  total_cwes: number;
}

// BubblesView data types - Animated bubbles where size = risk score
export interface BubbleData {
  cve_id: string;
  risk_score: number;
  cvss_score: number;
  epss_score: number;
  severity: "Critical" | "High" | "Medium" | "Low";
  is_kev: boolean;
  ssvc_decision: "Act" | "Attend" | "Track*" | "Track";
  title: string;
  affected_asset_count: number;
}

export interface BubblesViewData {
  bubbles: BubbleData[];
  total_cves: number;
  severity_distribution: {
    critical: number;
    high: number;
    medium: number;
    low: number;
  };
}

// DNAView data types - Double helix with CVE-Asset pairs
export interface DNAStrand {
  cve_id: string;
  asset_id: string;
  asset_hostname: string;
  cvss_score: number;
  severity: "Critical" | "High" | "Medium" | "Low";
  is_kev: boolean;
  exploit_available: boolean;
  position: number; // Position on the helix
}

export interface DNAViewData {
  strands: DNAStrand[];
  total_pairs: number;
  kev_pairs: number;
  exploitable_pairs: number;
}

// SankeyFlow data types - Remediation workflow visualization
export interface SankeyNode {
  id: string;
  name: string;
  count: number;
  color?: string;
}

export interface SankeyLink {
  source: string;
  target: string;
  value: number;
}

export interface SankeyFlowData {
  nodes: SankeyNode[];
  links: SankeyLink[];
  total_cves: number;
  remediated_count: number;
  in_progress_count: number;
  open_count: number;
}

// Common props for all view components
export interface VulnViewCommonProps {
  className?: string;
  onCVEClick?: (cveId: string) => void;
  isLoading?: boolean;
  error?: string | null;
}
