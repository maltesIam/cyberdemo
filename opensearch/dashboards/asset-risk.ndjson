{"type":"visualization","id":"asset-risk-heatmap","attributes":{"title":"Risk by Asset Type","visState":"{\"title\":\"Risk by Asset Type\",\"type\":\"heatmap\",\"params\":{\"type\":\"heatmap\",\"addTooltip\":true,\"addLegend\":true,\"enableHover\":false,\"legendPosition\":\"right\",\"times\":[],\"colorsNumber\":4,\"colorSchema\":\"Reds\",\"setColorRange\":false,\"colorsRange\":[],\"invertColors\":false,\"percentageMode\":false,\"valueAxes\":[{\"show\":false,\"id\":\"ValueAxis-1\",\"type\":\"value\",\"scale\":{\"type\":\"linear\",\"defaultYExtents\":false},\"labels\":{\"show\":false,\"rotate\":0,\"overwriteColor\":false,\"color\":\"#555\"}}]},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"avg\",\"schema\":\"metric\",\"params\":{\"field\":\"risk_score\",\"customLabel\":\"Avg Risk Score\"}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"segment\",\"params\":{\"field\":\"risk_level\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"missingBucket\":false,\"customLabel\":\"Risk Level\"}},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"group\",\"params\":{\"field\":\"hostname\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"missingBucket\":false,\"customLabel\":\"Asset\"}}]}","uiStateJSON":"{}","description":"Heatmap showing risk scores by asset type and risk level","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"index\":\"ctem-asset-risk-pattern\",\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"}}}
{"type":"visualization","id":"asset-top-vulnerable-table","attributes":{"title":"Top Vulnerable Assets","visState":"{\"title\":\"Top Vulnerable Assets\",\"type\":\"table\",\"params\":{\"perPage\":15,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":1,\"direction\":\"desc\"},\"showTotal\":false,\"totalFunc\":\"sum\",\"percentageCol\":\"\"},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"avg\",\"schema\":\"metric\",\"params\":{\"field\":\"risk_score\",\"customLabel\":\"Risk Score\"}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"hostname\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":15,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"customLabel\":\"Hostname\"}},{\"id\":\"3\",\"enabled\":true,\"type\":\"sum\",\"schema\":\"metric\",\"params\":{\"field\":\"vulnerability_count\",\"customLabel\":\"Vulnerabilities\"}},{\"id\":\"4\",\"enabled\":true,\"type\":\"sum\",\"schema\":\"metric\",\"params\":{\"field\":\"critical_count\",\"customLabel\":\"Critical\"}},{\"id\":\"5\",\"enabled\":true,\"type\":\"sum\",\"schema\":\"metric\",\"params\":{\"field\":\"high_count\",\"customLabel\":\"High\"}}]}","uiStateJSON":"{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"desc\"}}}}","description":"Table of assets with highest risk scores and vulnerability counts","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"index\":\"ctem-asset-risk-pattern\",\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"}}}
{"type":"visualization","id":"asset-overall-risk-gauge","attributes":{"title":"Overall Risk Score","visState":"{\"title\":\"Overall Risk Score\",\"type\":\"gauge\",\"params\":{\"type\":\"gauge\",\"addTooltip\":true,\"addLegend\":true,\"isDisplayWarning\":false,\"gauge\":{\"extendRange\":true,\"percentageMode\":false,\"gaugeType\":\"Arc\",\"gaugeStyle\":\"Full\",\"backStyle\":\"Full\",\"orientation\":\"vertical\",\"colorSchema\":\"Green to Red\",\"gaugeColorMode\":\"Labels\",\"colorsRange\":[{\"from\":0,\"to\":25},{\"from\":25,\"to\":50},{\"from\":50,\"to\":75},{\"from\":75,\"to\":100}],\"invertColors\":false,\"labels\":{\"show\":true,\"color\":\"black\"},\"scale\":{\"show\":true,\"labels\":false,\"color\":\"#333\"},\"type\":\"meter\",\"style\":{\"bgWidth\":0.9,\"width\":0.9,\"mask\":false,\"bgMask\":false,\"maskBars\":50,\"bgFill\":\"#eee\",\"bgColor\":true,\"subText\":\"\",\"fontSize\":60}}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"avg\",\"schema\":\"metric\",\"params\":{\"field\":\"risk_score\",\"customLabel\":\"Avg Risk\"}}]}","uiStateJSON":"{}","description":"Gauge showing overall average risk score across all assets","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"index\":\"ctem-asset-risk-pattern\",\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"}}}
{"type":"visualization","id":"asset-risk-distribution-pie","attributes":{"title":"Risk Level Distribution","visState":"{\"title\":\"Risk Level Distribution\",\"type\":\"pie\",\"params\":{\"type\":\"pie\",\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"right\",\"isDonut\":true,\"labels\":{\"show\":true,\"values\":true,\"last_level\":true,\"truncate\":100}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"segment\",\"params\":{\"field\":\"risk_level\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false}}]}","uiStateJSON":"{}","description":"Distribution of assets by risk level","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"index\":\"ctem-asset-risk-pattern\",\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"}}}
{"type":"visualization","id":"asset-ctem-findings-severity","attributes":{"title":"CTEM Findings by Severity","visState":"{\"title\":\"CTEM Findings by Severity\",\"type\":\"histogram\",\"params\":{\"type\":\"histogram\",\"grid\":{\"categoryLines\":false},\"categoryAxes\":[{\"id\":\"CategoryAxis-1\",\"type\":\"category\",\"position\":\"bottom\",\"show\":true,\"style\":{},\"scale\":{\"type\":\"linear\"},\"labels\":{\"show\":true,\"filter\":true,\"truncate\":100},\"title\":{}}],\"valueAxes\":[{\"id\":\"ValueAxis-1\",\"name\":\"LeftAxis-1\",\"type\":\"value\",\"position\":\"left\",\"show\":true,\"style\":{},\"scale\":{\"type\":\"linear\",\"mode\":\"normal\"},\"labels\":{\"show\":true,\"rotate\":0,\"filter\":false,\"truncate\":100},\"title\":{\"text\":\"Count\"}}],\"seriesParams\":[{\"show\":true,\"type\":\"histogram\",\"mode\":\"stacked\",\"data\":{\"label\":\"Count\",\"id\":\"1\"},\"valueAxis\":\"ValueAxis-1\",\"drawLinesBetweenPoints\":true,\"lineWidth\":2,\"showCircles\":true}],\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"right\",\"times\":[],\"addTimeMarker\":false},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"segment\",\"params\":{\"field\":\"severity\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5}},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"group\",\"params\":{\"field\":\"finding_type\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5}}]}","uiStateJSON":"{}","description":"CTEM findings grouped by severity and type","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"index\":\"ctem-findings-pattern\",\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"}}}
{"type":"search","id":"asset-risk-search","attributes":{"title":"Asset Risk Details","description":"Saved search for CTEM asset risk records","columns":["hostname","risk_score","risk_level","vulnerability_count","critical_count","high_count","calculated_at"],"sort":[["risk_score","desc"]],"kibanaSavedObjectMeta":{"searchSourceJSON":"{\"index\":\"ctem-asset-risk-pattern\",\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[],\"highlight\":{\"pre_tags\":[\"@opensearch-dashboards-highlighted-field@\"],\"post_tags\":[\"@/opensearch-dashboards-highlighted-field@\"],\"fields\":{\"*\":{}},\"fragment_size\":2147483647}}"}}}
{"type":"dashboard","id":"asset-risk-dashboard","attributes":{"title":"Asset Risk Dashboard","description":"CTEM asset risk analysis with heatmaps, vulnerability tables, and risk gauges","panelsJSON":"[{\"version\":\"2.0.0\",\"gridData\":{\"x\":0,\"y\":0,\"w\":16,\"h\":12,\"i\":\"1\"},\"panelIndex\":\"1\",\"embeddableConfig\":{},\"panelRefName\":\"panel_0\"},{\"version\":\"2.0.0\",\"gridData\":{\"x\":16,\"y\":0,\"w\":16,\"h\":12,\"i\":\"2\"},\"panelIndex\":\"2\",\"embeddableConfig\":{},\"panelRefName\":\"panel_1\"},{\"version\":\"2.0.0\",\"gridData\":{\"x\":32,\"y\":0,\"w\":16,\"h\":12,\"i\":\"3\"},\"panelIndex\":\"3\",\"embeddableConfig\":{},\"panelRefName\":\"panel_2\"},{\"version\":\"2.0.0\",\"gridData\":{\"x\":0,\"y\":12,\"w\":24,\"h\":14,\"i\":\"4\"},\"panelIndex\":\"4\",\"embeddableConfig\":{},\"panelRefName\":\"panel_3\"},{\"version\":\"2.0.0\",\"gridData\":{\"x\":24,\"y\":12,\"w\":24,\"h\":14,\"i\":\"5\"},\"panelIndex\":\"5\",\"embeddableConfig\":{},\"panelRefName\":\"panel_4\"}]","optionsJSON":"{\"hidePanelTitles\":false,\"useMargins\":true}","timeRestore":true,"timeTo":"now","timeFrom":"now-30d","refreshInterval":{"pause":false,"value":300000},"kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[]}"},"references":[{"name":"panel_0","type":"visualization","id":"asset-risk-heatmap"},{"name":"panel_1","type":"visualization","id":"asset-overall-risk-gauge"},{"name":"panel_2","type":"visualization","id":"asset-risk-distribution-pie"},{"name":"panel_3","type":"visualization","id":"asset-top-vulnerable-table"},{"name":"panel_4","type":"visualization","id":"asset-ctem-findings-severity"}]}}
